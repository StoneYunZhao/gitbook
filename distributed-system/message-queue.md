# Message Queue

## 介绍

### 使用场景

消息队列是分布式系统中的重要组件，主要用于解决什么问题呢？后者说为什么要使用消息队列？

**解耦：**如果一个系统A，调用了多个系统BCD。可能有新的系统E需要调用，老的系统D不再需要调用等情况。系统A还需要考虑C挂掉怎么办？需不需要重新调用？维护起来很麻烦。如果这个调用是不需要同步调用的，那么可以用MQ给他异步化解耦。

![](../.gitbook/assets/tu-pian%20%283%29.png)

**异步：**引入消息队列，将不是必须的业务逻辑异步处理，可以显著提高系统吞吐量。

![](../.gitbook/assets/tu-pian%20%281%29.png)

**削峰：**可以缓解短时间内高流量压垮应用**，**比如秒杀活动。

![](../.gitbook/assets/tu-pian.png)

### 缺点

引入消息队列可以有上述这么多作用，但是也会带来一些问题。

![](../.gitbook/assets/tu-pian%20%282%29.png)

**可用性降低：**系统引入的外部依赖越多，越容易挂掉。本来系统A调用BCD即可，现在加入MQ，若MQ挂了，整个系统就崩溃了。

**系统复杂度提高：**引入MQ就需要考虑MQ的问题。怎么保证消息没有重复消费？怎么处理消息丢失的情况？怎么保证消息传递的顺序性？

**一致性问题：**系统A处理完，发送消息后就返回成功的结果给用户。但是BCD收到消息后不一定能保证执行成功，若有一个系统执行失败了，整个处理结果是失败的。那么和用户得到的结果是不一致的。

### ActiveMQ、RabbitMQ、RocketMQ、Kafka比较







